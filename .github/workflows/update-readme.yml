name: Update README

on:
  push:
    branches:
      - main
  schedule:
    - cron: '0 0 * * *'  # ÐžÐ½Ð¾Ð²Ð»ÑŽÐ²Ð°Ñ‚Ð¸ Ñ€Ð°Ð· Ð½Ð° Ð´ÐµÐ½ÑŒ (Ñ‰Ð¾Ð´Ð½Ñ Ð¾ 00:00)

jobs:
  update-readme:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Set up Node.js
        uses: actions/setup-node@v2
        with:
          node-version: '14'

      - name: Get repo data and update README
        run: |
          # Ð’ÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÑŽÑ”Ð¼Ð¾ jq Ð´Ð»Ñ Ð¾Ð±Ñ€Ð¾Ð±ÐºÐ¸ JSON
          sudo apt-get install jq

          # ÐžÑ‚Ñ€Ð¸Ð¼ÑƒÑ”Ð¼Ð¾ Ð²ÑÑ– Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ñ–Ñ— Ñ‡ÐµÑ€ÐµÐ· API GitHub
          repos=$(curl -s "https://api.github.com/users/VorobeiIvan/repos" | jq -r '.[].name')

          # Ð¡Ñ‚Ð²Ð¾Ñ€ÑŽÑ”Ð¼Ð¾ Ð·Ð¼Ñ–Ð½Ð½Ñƒ Ð´Ð»Ñ Ð·Ð°Ð¿Ð¸ÑÑƒ Ð´Ð°Ð½Ð¸Ñ…
          readme_content="### ðŸ“¦ Ð ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ñ–Ñ—:\n"

          # ÐŸÐµÑ€ÐµÐ±Ð¸Ñ€Ð°Ñ”Ð¼Ð¾ Ð²ÑÑ– Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ñ–Ñ—
          for repo in $repos; do
            echo "Fetching details for $repo"
            
            # ÐžÑ‚Ñ€Ð¸Ð¼ÑƒÑ”Ð¼Ð¾ Ñ„Ð°Ð¹Ð»Ð¸ Ð·Ð°Ð»ÐµÐ¶Ð½Ð¾ÑÑ‚ÐµÐ¹
            repo_data=$(curl -s "https://api.github.com/repos/VorobeiIvan/$repo/contents")

            # Ð¨ÑƒÐºÐ°Ñ”Ð¼Ð¾ package.json Ð°Ð±Ð¾ Ñ–Ð½ÑˆÑ– Ñ„Ð°Ð¹Ð»Ð¸ Ð·Ð°Ð»ÐµÐ¶Ð½Ð¾ÑÑ‚ÐµÐ¹
            for file in $(echo "$repo_data" | jq -r '.[].name'); do
              if [[ "$file" == "package.json" ]]; then
                # Ð¯ÐºÑ‰Ð¾ Ñ” package.json, Ð´Ð¾Ð´Ð°Ñ”Ð¼Ð¾ Ð²Ñ–Ð´Ð¿Ð¾Ð²Ñ–Ð´Ð½Ñ– Ñ‚ÐµÑ…Ð½Ð¾Ð»Ð¾Ð³Ñ–Ñ—
                tech_stack="JavaScript, React, Redux"  # Ð¢ÑƒÑ‚ Ð¼Ð¾Ð¶Ðµ Ð±ÑƒÑ‚Ð¸ Ñ–Ð½ÑˆÐ¸Ð¹ ÐºÐ¾Ð´ Ð´Ð»Ñ Ð¿Ð°Ñ€ÑÐ¸Ð½Ð³Ñƒ package.json
                readme_content+="\n- **[$repo](https://github.com/VorobeiIvan/$repo)**\n  - **ÐœÐ¾Ð²Ð¸:** JavaScript\n  - **Ð¤Ñ€ÐµÐ¹Ð¼Ð²Ð¾Ñ€ÐºÐ¸:** React, Redux\n"
              fi
            done
          done

          # ÐžÐ½Ð¾Ð²Ð»ÑŽÑ”Ð¼Ð¾ README.md
          echo -e "$readme_content" > README.md
          
          git config --global user.name "GitHub Actions"
          git config --global user.email "actions@github.com"
          git add README.md
          git commit -m "Update README with latest repo details"
          git push
